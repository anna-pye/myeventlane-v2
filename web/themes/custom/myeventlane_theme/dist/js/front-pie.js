(function(v,S){v.behaviors.melFrontPie={attach(l){S("melFrontPie","[data-mel-pie]",l).forEach(e=>{const y=e.querySelectorAll("[data-mel-slice]"),n=e.querySelectorAll("[data-mel-legend]"),i=e.querySelector("[data-mel-tooltip]"),m=e.querySelector("[data-mel-tooltip-title]"),h=e.querySelector("[data-mel-tooltip-meta]"),c=()=>{y.forEach(t=>t.classList.remove("is-active")),n.forEach(t=>t.classList.remove("is-active")),i&&(i.classList.remove("is-active"),i.setAttribute("aria-hidden","true"))},d=(t,s)=>{c();const a=e.querySelector(`[data-mel-slice="${t}"]`),p=e.querySelector(`[data-mel-legend="${t}"]`);if(a&&a.classList.add("is-active"),p&&p.classList.add("is-active"),i&&a){const o=a.getAttribute("data-mel-label")||"",u=a.getAttribute("data-mel-count")||"0",r=a.getAttribute("data-mel-percent")||"0";if(m&&(m.textContent=o),h&&(h.textContent=`${u} events (${r}%)`),s&&s.clientX&&s.clientY){const g=e.getBoundingClientRect(),f=s.clientX-g.left,b=s.clientY-g.top;i.style.setProperty("--mel-tip-x",`${f}px`),i.style.setProperty("--mel-tip-y",`${b}px`)}i.classList.add("is-active"),i.setAttribute("aria-hidden","false")}};y.forEach(t=>{const s=t.getAttribute("data-mel-slice");s&&(t.addEventListener("mousemove",a=>d(s,a)),t.addEventListener("mouseenter",a=>d(s,a)),t.addEventListener("mouseleave",()=>c()))}),n.forEach(t=>{const s=t.getAttribute("data-mel-legend");s&&(t.addEventListener("mouseenter",()=>d(s,null)),t.addEventListener("mouseleave",()=>c()))}),e.ownerDocument.querySelectorAll("[data-mel-cat]").forEach(t=>{const s=t.getAttribute("data-mel-cat");s&&(t.addEventListener("mouseenter",()=>d(s,null)),t.addEventListener("mouseleave",()=>c()))})})}},v.behaviors.melFrontDebugCards={attach(l){S("melFrontDebugCards","body",l).forEach(()=>{const e=l&&l.ownerDocument?l.ownerDocument:document,y=!!e.querySelector(".mel-page--front, .mel-front, .mel-front-hero"),n=e.querySelector(".mel-events-grid"),i=e.querySelector(".mel-event-grid"),m=n?n.querySelector(".view-content"):null,h=e.querySelectorAll(".mel-event-card").length,c=n?n.querySelectorAll(".mel-event-card, .views-row, article").length:0,d=n?(n.textContent||"").trim().length:0,t=n&&e.defaultView?e.defaultView.getComputedStyle(n).display:null,s=m&&e.defaultView?e.defaultView.getComputedStyle(m).display:null,a=i&&e.defaultView?e.defaultView.getComputedStyle(i).display:null,p=n?/no results|no events|no content/i.test(n.textContent||""):!1;fetch("http://127.0.0.1:7242/ingest/a1ba5d3f-5aeb-448c-b801-95693370f59d",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:"debug-session",runId:"run1",hypothesisId:"A",location:"src/js/front-pie.js:melFrontDebugCards",message:"Front cards snapshot",data:{isFront:y,hasGrid:!!n,cardCount:h,gridItemCount:c,gridTextLen:d,hasNoResultsText:p},timestamp:Date.now()})}).catch(()=>{}),fetch("http://127.0.0.1:7242/ingest/a1ba5d3f-5aeb-448c-b801-95693370f59d",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:"debug-session",runId:"run1",hypothesisId:"B",location:"src/js/front-pie.js:melFrontDebugCards",message:"Front grids computed display",data:{gridDisplay:t,viewDisplay:s,eventGridDisplay:a},timestamp:Date.now()})}).catch(()=>{});const o=e.querySelector(".mel-event-card");if(o&&e.defaultView){const u=o.getBoundingClientRect(),r=e.defaultView.getComputedStyle(o),g=o.querySelector(".mel-event-card-image"),f=o.querySelector(".mel-event-card-body"),b=o.querySelector(".mel-event-card-title");fetch("http://127.0.0.1:7242/ingest/a1ba5d3f-5aeb-448c-b801-95693370f59d",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:"debug-session",runId:"run1",hypothesisId:"C",location:"src/js/front-pie.js:melFrontDebugCards",message:"First card rect + computed",data:{rect:{x:u.x,y:u.y,w:u.width,h:u.height},display:r.display,visibility:r.visibility,opacity:r.opacity,bg:r.backgroundColor,shadow:r.boxShadow},timestamp:Date.now()})}).catch(()=>{}),fetch("http://127.0.0.1:7242/ingest/a1ba5d3f-5aeb-448c-b801-95693370f59d",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:"debug-session",runId:"run1",hypothesisId:"D",location:"src/js/front-pie.js:melFrontDebugCards",message:"First card structure",data:{hasImage:!!g,hasBody:!!f,hasTitle:!!b,childCount:o.children?o.children.length:null},timestamp:Date.now()})}).catch(()=>{})}})}}})(Drupal,once);

let t={toggle:null,mobileNav:null,closeBtn:null,overlay:null,initialized:!1};function y(){if(t.initialized)return;if(t.toggle=document.querySelector(".mel-nav-toggle"),t.mobileNav=document.querySelector(".mel-nav-mobile-wrapper"),t.closeBtn=document.querySelector(".mel-nav-mobile-close"),t.overlay=document.querySelector(".mel-nav-overlay"),!t.toggle||!t.mobileNav){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",y):setTimeout(y,100);return}t.overlay||(t.overlay=document.createElement("div"),t.overlay.className="mel-nav-overlay",t.overlay.setAttribute("aria-hidden","true"),t.overlay.setAttribute("tabindex","-1"),document.body.appendChild(t.overlay)),t.initialized=!0;const o=()=>{const e=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(", ");return Array.from(t.mobileNav.querySelectorAll(e))};let a=null;function r(e){if(!t.mobileNav.classList.contains("is-open"))return;const n=o();if(n.length===0)return;const i=n[0],s=n[n.length-1];e.key==="Tab"&&(e.shiftKey?document.activeElement===i&&(e.preventDefault(),s.focus()):document.activeElement===s&&(e.preventDefault(),i.focus()))}function b(){a=document.activeElement,t.mobileNav.classList.add("is-open"),t.toggle.classList.add("is-active"),t.overlay.classList.add("is-visible"),t.toggle.setAttribute("aria-expanded","true"),t.mobileNav.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden";const e=t.mobileNav.querySelector("a, button");e&&setTimeout(()=>e.focus(),100),document.addEventListener("keydown",r)}function d(){t.mobileNav.classList.remove("is-open"),t.toggle.classList.remove("is-active"),t.overlay.classList.remove("is-visible"),t.toggle.setAttribute("aria-expanded","false"),t.mobileNav.setAttribute("aria-hidden","true"),document.body.style.overflow="",document.removeEventListener("keydown",r),a&&typeof a.focus=="function"?setTimeout(()=>a.focus(),100):t.toggle.focus()}document.addEventListener("click",function(e){if(e.target.closest(".mel-nav-toggle")){e.preventDefault(),e.stopPropagation(),t.mobileNav.classList.contains("is-open")?d():b();return}if(e.target.closest(".mel-nav-mobile-close")||e.target.closest("[data-nav-close]")){e.preventDefault(),e.stopPropagation(),d();return}if(e.target===t.overlay||e.target.classList.contains("mel-nav-overlay")){e.preventDefault(),e.stopPropagation(),d();return}},!0),document.addEventListener("keydown",function(e){e.key==="Escape"&&t.mobileNav.classList.contains("is-open")&&d()});const c=window.matchMedia("(min-width: 768px)");c.addEventListener?c.addEventListener("change",function(e){e.matches&&t.mobileNav.classList.contains("is-open")&&d()}):c.addListener(function(e){e.matches&&t.mobileNav.classList.contains("is-open")&&d()})}(function(o){const a=new WeakMap;o.behaviors.eventFormConditionalFields={attach:function(r,b){const d=r.querySelector('form.node-event-form, form[id*="node-event-form"], .mel-event-form-wrapper form');if(!d)return;const c=['select[name="field_event_type[0][value]"]','select[data-booking-type-select="true"]','select[name*="field_event_type"][name*="value"]','.mel-form-content select[name*="field_event_type"]','.booking_config select[name*="field_event_type"]','select[name*="field_event_type"]'];let e=null;for(let l=0;l<c.length;l++)if(e=r.querySelector(c[l]),e){console.log("Event form: Found select with selector:",c[l]);break}if(!e){d&&console.warn("Event form: Could not find field_event_type select element");return}if(typeof o<"u"&&o.behaviors&&setTimeout(function(){if(typeof o.states<"u"&&o.states.trigger&&o.states.trigger(e,"change"),typeof jQuery<"u"&&jQuery(e).length)jQuery(e).trigger("change").trigger("input");else if(e){const l=new Event("change",{bubbles:!0,cancelable:!0}),u=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(l),e.dispatchEvent(u)}},300),a.has(e))return;const n=r.querySelector(".mel-booking-rsvp"),i=r.querySelector(".mel-booking-paid"),s=r.querySelector(".mel-booking-external");console.log("Event form: Containers found - RSVP:",!!n,"Paid:",!!i,"External:",!!s);const m=function(){const l=e.value;if(console.log("Event form: Fallback visibility check for value:",l),n){const u=window.getComputedStyle(n),f=u.display!=="none"&&u.visibility!=="hidden",v=l==="rsvp"||l==="both";v&&!f?(console.warn("Event form: Fallback - showing RSVP fields"),n.style.display="block",n.removeAttribute("data-force-hidden")):!v&&f&&!n.hasAttribute("data-conditional-fields-processed")&&(n.style.display="none",n.setAttribute("data-force-hidden","true"))}if(i){const u=window.getComputedStyle(i),f=u.display!=="none"&&u.visibility!=="hidden",v=l==="paid"||l==="both";v&&!f?(console.warn("Event form: Fallback - showing Paid fields"),i.style.display="block",i.removeAttribute("data-force-hidden")):!v&&f&&!i.hasAttribute("data-conditional-fields-processed")&&(i.style.display="none",i.setAttribute("data-force-hidden","true"))}if(s){const u=window.getComputedStyle(s),f=u.display!=="none"&&u.visibility!=="hidden",v=l==="external";v&&!f?(console.warn("Event form: Fallback - showing External fields"),s.style.display="block",s.removeAttribute("data-force-hidden")):!v&&f&&!s.hasAttribute("data-conditional-fields-processed")&&(s.style.display="none",s.setAttribute("data-force-hidden","true"))}};setTimeout(function(){n&&!n.hasAttribute("data-conditional-fields-processed")&&m(),i&&!i.hasAttribute("data-conditional-fields-processed")&&m(),s&&!s.hasAttribute("data-conditional-fields-processed")&&m()},500),e.addEventListener("change",function(){typeof o.states<"u"&&o.states.trigger&&o.states.trigger(e,"change"),setTimeout(function(){m()},150)});let p=null;(n||i||s)&&(p=setInterval(function(){e.value&&(n&&n.hasAttribute("data-force-hidden")&&!n.hasAttribute("data-conditional-fields-processed")||i&&i.hasAttribute("data-force-hidden")&&!i.hasAttribute("data-conditional-fields-processed")||s&&s.hasAttribute("data-force-hidden")&&!s.hasAttribute("data-conditional-fields-processed"))&&(console.warn("Event form: Conditional fields not working, using fallback"),m())},3e3),a.set(e,p))},detach:function(r,b,d){const c=['select[name="field_event_type[0][value]"]','select[name*="field_event_type"][name*="value"]','select[name*="field_event_type"]'];for(let e=0;e<c.length;e++){const n=r.querySelector(c[e]);if(n&&a.has(n)){const i=a.get(n);i&&(clearInterval(i),a.delete(n),console.log("Event form: Cleaned up interval for select element"));break}}}}})(Drupal);(function(){function o(a){y()}typeof Drupal<"u"&&Drupal.behaviors&&(Drupal.behaviors.myeventlaneTheme={attach:function(a,r){o()}}),document.readyState==="loading"?(document.addEventListener("DOMContentLoaded",function(){o()}),setTimeout(function(){o()},0)):o(),setTimeout(function(){o()},500)})();

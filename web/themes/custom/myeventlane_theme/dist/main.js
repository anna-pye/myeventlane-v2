let t={toggle:null,mobileNav:null,closeBtn:null,overlay:null,initialized:!1};function b(){if(t.initialized)return;if(t.toggle=document.querySelector(".mel-nav-toggle"),t.mobileNav=document.querySelector(".mel-nav-mobile-wrapper"),t.closeBtn=document.querySelector(".mel-nav-mobile-close"),t.overlay=document.querySelector(".mel-nav-overlay"),!t.toggle||!t.mobileNav){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",b):setTimeout(b,100);return}t.overlay||(t.overlay=document.createElement("div"),t.overlay.className="mel-nav-overlay",t.overlay.setAttribute("aria-hidden","true"),t.overlay.setAttribute("tabindex","-1"),document.body.appendChild(t.overlay)),t.initialized=!0;const s=()=>{const e=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(", ");return Array.from(t.mobileNav.querySelectorAll(e))};let a=null;function c(e){if(!t.mobileNav.classList.contains("is-open"))return;const n=s();if(n.length===0)return;const o=n[0],u=n[n.length-1];e.key==="Tab"&&(e.shiftKey?document.activeElement===o&&(e.preventDefault(),u.focus()):document.activeElement===u&&(e.preventDefault(),o.focus()))}function m(){a=document.activeElement,t.mobileNav.classList.add("is-open"),t.toggle.classList.add("is-active"),t.overlay.classList.add("is-visible"),t.toggle.setAttribute("aria-expanded","true"),t.mobileNav.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden";const e=t.mobileNav.querySelector("a, button");e&&setTimeout(()=>e.focus(),100),document.addEventListener("keydown",c)}function d(){t.mobileNav.classList.remove("is-open"),t.toggle.classList.remove("is-active"),t.overlay.classList.remove("is-visible"),t.toggle.setAttribute("aria-expanded","false"),t.mobileNav.setAttribute("aria-hidden","true"),document.body.style.overflow="",document.removeEventListener("keydown",c),a&&typeof a.focus=="function"?setTimeout(()=>a.focus(),100):t.toggle.focus()}document.addEventListener("click",function(e){if(e.target.closest(".mel-nav-toggle")){e.preventDefault(),e.stopPropagation(),t.mobileNav.classList.contains("is-open")?d():m();return}if(e.target.closest(".mel-nav-mobile-close")||e.target.closest("[data-nav-close]")){e.preventDefault(),e.stopPropagation(),d();return}if(e.target===t.overlay||e.target.classList.contains("mel-nav-overlay")){e.preventDefault(),e.stopPropagation(),d();return}},!0),document.addEventListener("keydown",function(e){e.key==="Escape"&&t.mobileNav.classList.contains("is-open")&&d()});const i=window.matchMedia("(min-width: 768px)");i.addEventListener?i.addEventListener("change",function(e){e.matches&&t.mobileNav.classList.contains("is-open")&&d()}):i.addListener(function(e){e.matches&&t.mobileNav.classList.contains("is-open")&&d()})}(function(s){const a=new WeakMap;s.behaviors.eventFormConditionalFields={attach:function(c,m){const d=['select[name="field_event_type[0][value]"]','select[data-booking-type-select="true"]','select[name*="field_event_type"][name*="value"]','.mel-form-content select[name*="field_event_type"]','.booking_config select[name*="field_event_type"]','select[name*="field_event_type"]'];let i=null;for(let l=0;l<d.length;l++)if(i=c.querySelector(d[l]),i){console.log("Event form: Found select with selector:",d[l]);break}if(!i){console.warn("Event form: Could not find field_event_type select element");return}if(typeof s<"u"&&s.behaviors&&setTimeout(function(){if(typeof s.states<"u"&&s.states.trigger&&s.states.trigger(i,"change"),typeof jQuery<"u"&&jQuery(i).length)jQuery(i).trigger("change").trigger("input");else if(i){const l=new Event("change",{bubbles:!0,cancelable:!0}),r=new Event("input",{bubbles:!0,cancelable:!0});i.dispatchEvent(l),i.dispatchEvent(r)}},300),a.has(i))return;const e=c.querySelector(".mel-booking-rsvp"),n=c.querySelector(".mel-booking-paid"),o=c.querySelector(".mel-booking-external");console.log("Event form: Containers found - RSVP:",!!e,"Paid:",!!n,"External:",!!o);const u=function(){const l=i.value;if(console.log("Event form: Fallback visibility check for value:",l),e){const r=window.getComputedStyle(e),f=r.display!=="none"&&r.visibility!=="hidden",v=l==="rsvp"||l==="both";v&&!f?(console.warn("Event form: Fallback - showing RSVP fields"),e.style.display="block",e.removeAttribute("data-force-hidden")):!v&&f&&!e.hasAttribute("data-conditional-fields-processed")&&(e.style.display="none",e.setAttribute("data-force-hidden","true"))}if(n){const r=window.getComputedStyle(n),f=r.display!=="none"&&r.visibility!=="hidden",v=l==="paid"||l==="both";v&&!f?(console.warn("Event form: Fallback - showing Paid fields"),n.style.display="block",n.removeAttribute("data-force-hidden")):!v&&f&&!n.hasAttribute("data-conditional-fields-processed")&&(n.style.display="none",n.setAttribute("data-force-hidden","true"))}if(o){const r=window.getComputedStyle(o),f=r.display!=="none"&&r.visibility!=="hidden",v=l==="external";v&&!f?(console.warn("Event form: Fallback - showing External fields"),o.style.display="block",o.removeAttribute("data-force-hidden")):!v&&f&&!o.hasAttribute("data-conditional-fields-processed")&&(o.style.display="none",o.setAttribute("data-force-hidden","true"))}};setTimeout(function(){e&&!e.hasAttribute("data-conditional-fields-processed")&&u(),n&&!n.hasAttribute("data-conditional-fields-processed")&&u(),o&&!o.hasAttribute("data-conditional-fields-processed")&&u()},500),i.addEventListener("change",function(){typeof s.states<"u"&&s.states.trigger&&s.states.trigger(i,"change"),setTimeout(function(){u()},150)});let y=null;(e||n||o)&&(y=setInterval(function(){i.value&&(e&&e.hasAttribute("data-force-hidden")&&!e.hasAttribute("data-conditional-fields-processed")||n&&n.hasAttribute("data-force-hidden")&&!n.hasAttribute("data-conditional-fields-processed")||o&&o.hasAttribute("data-force-hidden")&&!o.hasAttribute("data-conditional-fields-processed"))&&(console.warn("Event form: Conditional fields not working, using fallback"),u())},3e3),a.set(i,y))},detach:function(c,m,d){const i=['select[name="field_event_type[0][value]"]','select[name*="field_event_type"][name*="value"]','select[name*="field_event_type"]'];for(let e=0;e<i.length;e++){const n=c.querySelector(i[e]);if(n&&a.has(n)){const o=a.get(n);o&&(clearInterval(o),a.delete(n),console.log("Event form: Cleaned up interval for select element"));break}}}}})(Drupal);(function(){function s(a){b()}typeof Drupal<"u"&&Drupal.behaviors&&(Drupal.behaviors.myeventlaneTheme={attach:function(a,c){s()}}),document.readyState==="loading"?(document.addEventListener("DOMContentLoaded",function(){s()}),setTimeout(function(){s()},0)):s(),setTimeout(function(){s()},500)})();

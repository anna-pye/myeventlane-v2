{#
  Vendor payouts management page.
  Variables: summary (totals), history (recent transactions), stripe_manage_url.
#}
<div class="mel-page-header">
  <div class="mel-page-header__content">
    <h2 class="mel-page-header__subtitle">{{ 'Your earnings'|t }}</h2>
    <p class="mel-page-header__description">
      {{ 'View your sales, fees, and payout history. Manage your Stripe account for detailed financial reports.'|t }}
    </p>
  </div>
  {% if stripe_manage_url %}
    <div class="mel-page-header__actions">
      <a href="{{ stripe_manage_url }}" class="mel-btn mel-btn--secondary" target="_blank" rel="noopener">
        <span class="mel-icon">ğŸ’³</span>
        {{ 'Open Stripe Dashboard'|t }}
      </a>
    </div>
  {% endif %}
</div>

<div class="mel-grid mel-grid--4">
  <div class="mel-card mel-card--stat">
    <div class="mel-stat">
      <div class="mel-stat__icon">ğŸ’°</div>
      <div class="mel-stat__label">{{ 'Total sales'|t }}</div>
      <div class="mel-stat__value">{{ summary.total_sales|default('$0.00') }}</div>
    </div>
  </div>
  <div class="mel-card mel-card--stat">
    <div class="mel-stat">
      <div class="mel-stat__icon">ğŸ“Š</div>
      <div class="mel-stat__label">{{ 'Platform fees'|t }}</div>
      <div class="mel-stat__value">{{ summary.total_fees|default('$0.00') }}</div>
    </div>
  </div>
  <div class="mel-card mel-card--stat">
    <div class="mel-stat">
      <div class="mel-stat__icon">âœ…</div>
      <div class="mel-stat__label">{{ 'Net earnings'|t }}</div>
      <div class="mel-stat__value mel-text--success">{{ summary.net_earnings|default('$0.00') }}</div>
    </div>
  </div>
  <div class="mel-card mel-card--stat">
    <div class="mel-stat">
      <div class="mel-stat__icon">â³</div>
      <div class="mel-stat__label">{{ 'Pending payout'|t }}</div>
      <div class="mel-stat__value">{{ summary.pending_payout|default('$0.00') }}</div>
    </div>
  </div>
</div>

<div class="mel-card">
  <div class="mel-card__header">
    <div class="mel-card__title">{{ 'Recent transactions'|t }}</div>
  </div>
  
  {% if history|length > 0 %}
    <div class="mel-table">
      <div class="mel-table__head">
        <div>{{ 'Date'|t }}</div>
        <div>{{ 'Event'|t }}</div>
        <div>{{ 'Amount'|t }}</div>
        <div>{{ 'Status'|t }}</div>
      </div>
      <div class="mel-table__body">
        {% for item in history %}
          <div class="mel-table__row">
            <div>{{ item.date }}</div>
            <div>{{ item.event|default('â€”') }}</div>
            <div class="mel-text--bold">{{ item.amount }}</div>
            <div>
              <span class="mel-badge mel-badge--{{ item.status|lower }}">
                {{ item.status }}
              </span>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  {% else %}
    <div class="mel-empty">
      <div class="mel-empty__icon">ğŸ’¸</div>
      <div class="mel-empty__title">{{ 'No transactions yet'|t }}</div>
      <div class="mel-empty__description">
        {{ 'When you make sales, they will appear here.'|t }}
      </div>
    </div>
  {% endif %}
</div>

<div class="mel-card mel-card--info">
  <div class="mel-card__header">
    <div class="mel-card__title">{{ 'About payouts'|t }}</div>
  </div>
  <div class="mel-card__body">
    <div class="mel-grid mel-grid--2">
      <div class="mel-feature">
        <div class="mel-feature__icon">ğŸ¦</div>
        <div class="mel-feature__title">{{ 'Automatic payouts'|t }}</div>
        <div class="mel-feature__description">
          {{ 'Your earnings are automatically transferred to your connected bank account on a rolling basis.'|t }}
        </div>
      </div>
      <div class="mel-feature">
        <div class="mel-feature__icon">ğŸ“‹</div>
        <div class="mel-feature__title">{{ 'Detailed reports'|t }}</div>
        <div class="mel-feature__description">
          {{ 'Access full transaction history, tax documents, and financial reports in your Stripe dashboard.'|t }}
        </div>
      </div>
    </div>
    
    {% if stripe_manage_url %}
      <div class="mel-card__footer">
        <a href="{{ stripe_manage_url }}" class="mel-btn mel-btn--primary" target="_blank" rel="noopener">
          {{ 'Manage payouts in Stripe'|t }}
        </a>
      </div>
    {% else %}
      <div class="mel-alert mel-alert--warning">
        <div class="mel-alert__icon">âš ï¸</div>
        <div class="mel-alert__content">
          <div class="mel-alert__title">{{ 'Stripe not connected'|t }}</div>
          <div class="mel-alert__description">
            {{ 'Connect your Stripe account to receive payouts for ticket sales.'|t }}
          </div>
          <a href="/vendor/stripe/connect" class="mel-btn mel-btn--primary mel-btn--sm">
            {{ 'Connect Stripe'|t }}
          </a>
        </div>
      </div>
    {% endif %}
  </div>
</div>


{#
/**
 * @file
 * Default page template for the MyEventLane Vendor Console.
 *
 * Two-column layout with:
 * - Left sidebar navigation (mel-sidebar)
 * - Main content area with header
 * - Optional right-hand help sidebar (future feature)
 */
#}
{% set sidebar = include('@myeventlane_vendor_theme/includes/sidebar.html.twig', { page: page }, with_context = false) %}
{% set header = include('@myeventlane_vendor_theme/includes/header.html.twig', { page: page }, with_context = false) %}
{% set footer = include('@myeventlane_vendor_theme/includes/footer.html.twig', { page: page }, with_context = false) %}

{# Mobile sidebar overlay #}
<div class="mel-sidebar-overlay" data-sidebar-overlay></div>

<div class="mel-vendor-shell">
  {# Left Navigation Sidebar #}
  <aside class="mel-vendor-shell__sidebar" role="navigation" aria-label="{{ 'Vendor navigation'|t }}" data-sidebar>
    {{ sidebar|raw }}
  </aside>

  {# Main Content Area #}
  <div class="mel-vendor-shell__main">
    {# Sticky Header #}
    <header class="mel-vendor-shell__header" role="banner">
      {{ header|raw }}
    </header>

    {# Main Content #}
    <main class="mel-vendor-shell__content" role="main">
      {# Messages #}
      {% if page.highlighted %}
        {{ page.highlighted }}
      {% endif %}
      
      {# Two-column layout wrapper when help sidebar is present #}
      {% if page.sidebar_help %}
        <div class="mel-layout--two-column">
          <div class="mel-layout__main">
            {% if page.content %}
              {{ page.content }}
            {% endif %}
          </div>
          <aside class="mel-layout__sidebar-help">
            {{ page.sidebar_help }}
          </aside>
        </div>
      {% else %}
        {# Standard full-width content #}
        {% if page.content %}
          {{ page.content }}
        {% endif %}
      {% endif %}
    </main>

    {# Footer #}
    <footer class="mel-vendor-shell__footer" role="contentinfo">
      {{ footer|raw }}
    </footer>
  </div>
</div>

{# Inline JavaScript for sidebar toggle (works without Vite build) #}
<script>
(function() {
  'use strict';
  
  document.addEventListener('DOMContentLoaded', function() {
    var sidebar = document.querySelector('[data-sidebar]');
    var overlay = document.querySelector('[data-sidebar-overlay]');
    var toggleBtns = document.querySelectorAll('[data-sidebar-toggle]');
    
    function openSidebar() {
      if (sidebar) sidebar.classList.add('is-open');
      if (overlay) overlay.classList.add('is-visible');
      document.body.style.overflow = 'hidden';
    }
    
    function closeSidebar() {
      if (sidebar) sidebar.classList.remove('is-open');
      if (overlay) overlay.classList.remove('is-visible');
      document.body.style.overflow = '';
    }
    
    toggleBtns.forEach(function(btn) {
      btn.addEventListener('click', function(e) {
        e.preventDefault();
        if (sidebar && sidebar.classList.contains('is-open')) {
          closeSidebar();
        } else {
          openSidebar();
        }
      });
    });
    
    if (overlay) {
      overlay.addEventListener('click', closeSidebar);
    }
    
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && sidebar && sidebar.classList.contains('is-open')) {
        closeSidebar();
      }
    });
  });
})();
</script>


  private function getStripeStatus(): array {
    $currentUser = $this->currentUser();
    $userId = (int) $currentUser->id();

    if ($userId === 0) {
      return [
        'connected' => FALSE,
        'status' => 'unconnected',
        'status_label' => $this->t('Not Connected'),
        'status_message' => $this->t('Connect your Stripe account to start accepting payments.'),
        'account_id' => NULL,
        'connect_url' => Url::fromRoute('myeventlane_vendor.stripe_connect')->toString(),
        'manage_url' => NULL,
      ];
    }

    // Find store for this user.
    $storeStorage = $this->entityTypeManager()->getStorage('commerce_store');
    $storeIds = $storeStorage->getQuery()
      ->accessCheck(FALSE)
      ->condition('uid', $userId)
      ->range(0, 1)
      ->execute();

    if (empty($storeIds)) {
      return [
        'connected' => FALSE,
        'status' => 'unconnected',
        'status_label' => $this->t('Not Connected'),
        'status_message' => $this->t('Connect your Stripe account to start accepting payments.'),
        'account_id' => NULL,
        'connect_url' => Url::fromRoute('myeventlane_vendor.stripe_connect')->toString(),
        'manage_url' => NULL,
      ];
    }

    $store = $storeStorage->load(reset($storeIds));
    if (!$store) {
      return [
        'connected' => FALSE,
        'status' => 'unconnected',
        'status_label' => $this->t('Not Connected'),
        'status_message' => $this->t('Connect your Stripe account to start accepting payments.'),
        'account_id' => NULL,
        'connect_url' => Url::fromRoute('myeventlane_vendor.stripe_connect')->toString(),
        'manage_url' => NULL,
      ];
    }

    // Check for Stripe account ID.
    $accountId = NULL;
    $status = 'unconnected';
    $connected = FALSE;

    if ($store->hasField('field_stripe_account_id') && !$store->get('field_stripe_account_id')->isEmpty()) {
      $accountId = $store->get('field_stripe_account_id')->value;
    }

    if ($store->hasField('field_stripe_status') && !$store->get('field_stripe_status')->isEmpty()) {
      $status = $store->get('field_stripe_status')->value;
    }
    elseif ($store->hasField('field_stripe_connected') && !$store->get('field_stripe_connected')->isEmpty()) {
      $connected = (bool) $store->get('field_stripe_connected')->value;
      $status = $connected ? 'complete' : 'pending';
    }
    elseif (!empty($accountId)) {
      $status = 'pending';
    }

    if ($status === 'complete') {
      $connected = TRUE;
    }

    // Build status labels and messages.
    $statusLabel = $this->t('Not Connected');
    $statusMessage = $this->t('Connect your Stripe account to start accepting payments.');

    if ($connected) {
      $statusLabel = $this->t('Connected');
      $statusMessage = $this->t('Your Stripe account is active and ready to accept payments.');
    }
    elseif ($status === 'pending') {
      $statusLabel = $this->t('Pending');
      $statusMessage = $this->t('Your Stripe account is pending verification. Complete onboarding to start accepting payments.');
    }

    return [
      'connected' => $connected,
      'status' => $status,
      'status_label' => $statusLabel,
      'status_message' => $statusMessage,
      'account_id' => $accountId,
      'connect_url' => Url::fromRoute('myeventlane_vendor.stripe_connect')->toString(),
      'manage_url' => !empty($accountId) ? Url::fromRoute('myeventlane_vendor.stripe_manage')->toString() : NULL,
    ];
  }
